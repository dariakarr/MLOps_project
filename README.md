### Автоматическая диагностика пневмонии на основе рентгеновских снимков грудной клетки

#### Формулировка задачи
Цель проекта — разработка модели глубокого обучения для автоматической классификации рентгеновских снимков грудной клетки на две категории: с пневмонией и без пневмонии.  
Проект направлен на повышение эффективности диагностики пневмонии, снижение нагрузки на врачей и минимизацию ошибок, связанных с человеческим фактором. Данное решение будет полезно в клинической практике, особенно в условиях ограниченного доступа к квалифицированным радиологам.

#### **Данные**
1. **Источник данных**:
   Данные будут взяты из открытого датасета [Chest X-Ray Images (Pneumonia)](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia). Датасет содержит 5 863 рентгеновских снимка грудной клетки.

2. **Особенности данных**:  
   - Изображения разделены на две категории: с пневмонией и без неё.  
   - Данные уже разбиты на обучающую, тестовую и валидационную выборки.  
   - Снимки включают как случаи бактериальной, так и вирусной пневмонии.  

3. **Проблемы и их решение**:  
   - **Шум в данных**: Возможны артефакты, такие как размытость изображения или наложение текста. Решение — предварительная очистка данных.  
   - **Дисбаланс классов**: Класс "с пневмонией" представлен чаще, чем "без пневмонии". Это будет учтено при обучении.  

4. **Объем данных**:  
   Количество изображений и их аннотации достаточно для обучения и тестирования современных моделей компьютерного зрения.

#### **Подход к моделированию**
1. **Модель**:  
   - Базовая архитектура: **ResNet-50**, как проверенная модель для задач классификации изображений.  
   - Библиотеки: `PyTorch` для реализации модели, `Albumentations` для аугментации данных.  

2. **Конфигурация решения**:  
   - **Препроцессинг данных**:  
     - Преобразование изображений в формат 224×224.  
     - Аугментации, такие как горизонтальное отражение, изменения яркости и контрастности, добавление шума.  
   - **Обучение**:  
     - Оптимизатор: Adam с обучением на GPU (Google Colab).  
     - Функция потерь: Binary Cross-Entropy с модификацией для дисбалансированных данных.  

3. **Схема обучения**:  
   1. Сбор данных -> 2. Препроцессинг -> 3. Обучение модели -> 4. Валидация и тестирование.

#### **Способ предсказания и продакшен-пайплайн**
1. **Пайплайн**:  
   После обучения модель будет обёрнута в MLOps-пайплайн с использованием `Docker` и `FastAPI`.  

   - **Шаги пайплайна**:  
     1. Получение изображения: Загрузка снимков через веб-интерфейс или API.  
     2. Препроцессинг: Преобразование изображения к стандартному формату.  
     3. Инференс модели: Получение предсказания.  
     4. Постобработка: Визуализация результатов и сохранение данных в базе.  

   - **Мониторинг и логирование**: Интеграция с `MLflow` для отслеживания метрик модели, использование `Prometheus` для мониторинга сервиса.

2. **Финальное применение**:  
   Модель будет использоваться в медицинских учреждениях для предварительной диагностики пневмонии. Пользователь (врач) загружает рентгеновский снимок, система выдаёт вероятность наличия пневмонии и визуализацию классифицированных областей.

#### **Архитектура решения** 
Рентгеновский снимок -> Препроцессинг -> ResNet-50 -> Постобработка -> API -> Отчёт.  

**MLOps-инструменты**:  `PyTorch`, `Docker`, `FastAPI`, `MLflow`, `Prometheus`.  